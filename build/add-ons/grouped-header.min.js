"use strict";!function(){var e={mixInTo:function(e,t){t=t||{};var r=Object.getPrototypeOf(e.cellRenderers.get("SimpleCell")).constructor,i=r.extend("GroupedHeader",{paint:this.paintHeaderGroups,delimiter:"|",groupColor:"rgb(144, 144, 144)",paintBackground:this.drawProportionalBottomBorder,gradientStops:[[0,"rgba(144, 144, 144, 0)"],[1,"rgba(144, 144, 144, .35)"]]}),o=e.cellRenderers.add(i);o.groups=[],t.delimiter&&(o.delimiter=e.behavior.dataModel.groupHeaderDelimiter=t.delimiter),t.groupColor&&(o.groupColor=t.groupColor),t.paintBackground&&(o.paintBackground=t.paintBackground,t.paintBackground===this.drawLinearGradient&&t.gradientStops&&(this.gradientStops=t.gradientStops)),e.behavior.setHeaders=this.setHeaders},setHeaders:function(e){var t=this.grid.cellRenderers.get("GroupedHeader").delimiter;Object.getPrototypeOf(this).setHeaders.call(this,e);var r=this.allColumns.reduce(function(e,r){return Math.max(r.header.split(t).length,e)},0);this.grid.setState({rowHeights:{0:4*r/3*this.grid.behavior.getDefaultRowHeight()}})},paintHeaderGroups:function(e,t){var r=this["super"].paint;if(0===t.y&&t.x>=0){var i,o=this.groups,a=t.value.split(this.delimiter),d=a.length-1;if(0!==d&&0!==t.x||(o.length=0),d){var n=t.bounds,l=n.x,s=n.width,h=t.isColumnHovered,u=t.isSelected,g=t.font,p=t.color;n.height/=a.length;for(var c=0,f=n.y;c<d;c++,f+=n.height)o[c]&&a[c]===o[c].value?(i=o[c],i.width+=s):(i=o[c]=o[c]||{},i.value=a[c],i.left=l,i.width=s),n.x=i.left,n.y=f,n.width=i.width,t.value=i.value,t.isColumnHovered=t.isSelected=!1,t.font="bold "+g,t.color=this.groupColor,r.call(this,e,t),this.bounds=n,this.groupIndex=c,this.groupCount=d,this.paintBackground(e);n.x=l,n.y=f,n.width=s,t.value=a[c],t.isColumnHovered=h,t.isSelected=u,t.font=g,t.color=p}}r.call(this,e,t)},drawProportionalBottomBorder:function(e){var t=this.bounds,r=this.groupCount-this.groupIndex;e.beginPath(),e.strokeStyle=this.groupColor,e.lineWidth=r,e.moveTo(t.x+3,t.y+t.height-r),e.lineTo(t.x+t.width-2,t.y+t.height-r),e.stroke(),e.closePath()},drawLinearGradient:function(e){var t=this.bounds,r=e.createLinearGradient(t.x,t.y,t.x,t.y+t.height);this.gradientStops.forEach(function(e){r.addColorStop.apply(r,e)}),e.fillStyle=r,e.fillRect(t.x+2,t.y,t.width-3,t.height)}};window.fin.Hypergrid.groupedHeader=e}();